<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alive5 Voice Assistant</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/livekit-client@latest/dist/livekit-client.umd.js"></script>
</head>
<body>
    <div class="container">
        <!-- Chat Header -->
        <div class="chat-header">
            <div class="header-main">
                <div class="avatar">ðŸ¤–</div>
                <div class="header-info">
                    <h1 id="botName">Voice Assistant</h1>
                    <p id="botStatus">Ready to help</p>
                    <div class="intent-indicator">
                        <span class="intent-label">Intent:</span>
                        <span id="intentDisplay" class="intent-offline">Offline</span>
                    </div>
                </div>
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusText">Offline</span>
                </div>
            </div>
            <div class="session-details" id="sessionDetails" style="display: none;">
                <div class="session-info">
                    â€¢ <strong>Session ID:</strong> <code id="sessionIdDisplay"></code> <br>
                    â€¢ <strong>Status:</strong> Ready to connect to Alive5 Support <br>
                    â€¢ <strong>Features:</strong> Dynamic Intent Detection, Real-time Analytics <br>
                </div>
            </div>
        </div>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Connection Form (shown initially) -->
            <div id="connectionForm" class="connection-form">
                <div class="form-container">
                    <h2>Connect to Voice Assistant</h2>
                    <p>Select your bot and voice to start a conversation</p>

                    <form id="joinForm">
                        <div class="form-group">
                            <div class="form-group-label">
                                <label for="botchainName">Bot Name:</label>
                            </div>
                            <div class="form-group-content">
                                <input type="text" id="botchainName" name="botchainName" required
                                       placeholder="e.g., voice-1, dustin-gpt, sales-bot">
                                <small>Enter the name of the bot you want to connect to</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="form-group-label">
                                <label for="orgName">Org Name:</label>
                            </div>
                            <div class="form-group-content">
                                <input type="text" id="orgName" name="orgName" 
                                       placeholder="e.g., alive5stage0, your-org-name">
                                <small>Leave empty to use default configuration</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="form-group-label">
                                <label for="voiceSelect">Agent Voice:</label>
                            </div>
                            <div class="form-group-content">
                                <select id="voiceSelect" name="voiceSelect" class="voice-select" data-default-voice="7f423809-0011-4658-ba48-a411f5e516ba">
                                    <option value="">Loading voices...</option>
                                </select>
                                <small>Choose the voice for your AI assistant</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="form-group-label">
                                <label for="faqVerboseMode">FAQ Response Mode:</label>
                            </div>
                            <div class="form-group-content">
                                <div class="toggle-switch">
                                    <input type="checkbox" id="faqVerboseMode" name="faqVerboseMode" checked>
                                    <label for="faqVerboseMode" class="toggle-label">
                                        <span class="toggle-text">Verbose</span>
                                        <span class="toggle-slider"></span>
                                        <span class="toggle-text">Concise</span>
                                    </label>
                                </div>
                                <small>Verbose: Detailed responses | Concise: Short responses</small>
                            </div>
                        </div>

                        <button type="submit" id="joinBtn" class="btn">
                            ðŸŽ¤ Join Voice Chat
                        </button>
                    </form>
                </div>
            </div>

            <!-- Chat Messages (shown after connection) -->
            <div id="chatMessages" class="chat-messages" style="display: none;">
                <!-- Messages will be dynamically added here -->
            </div>
            
            <!-- Chat Input Area (shown after connection) -->
            <div id="chatInputArea" class="chat-input-area" style="display: none;">
                <div class="voice-controls">
                    <select id="voiceChangeSelect" class="voice-change-select" title="Change Voice">
                        <option value="">Loading voices...</option>
                    </select>
                    <div id="voiceVisualizer" class="voice-visualizer" style="display: none;">
                        <div class="voice-bar"></div>
                        <div class="voice-bar"></div>
                        <div class="voice-bar"></div>
                        <div class="voice-bar"></div>
                        <div class="voice-bar"></div>
                    </div>
                </div>
                
                <div class="connection-status" id="connectionStatus">
                    Ready to listen
                </div>

                <button id="disconnectBtn" class="voice-btn disconnect" title="Disconnect">
                    ðŸ“ž
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Environment Configuration -->
    <script>
        // Environment configuration
        window.API_BASE_URL = 'https://18.210.238.67.nip.io';
        window.BACKEND_URL = 'https://18.210.238.67.nip.io';
        window.FRONTEND_URL ='https://voice-agent-livekit.vercel.app';
        
        //console.log('ðŸ”§ Frontend Configuration:');
        //console.log('API Base URL:', window.API_BASE_URL);
        //console.log('Backend URL:', window.BACKEND_URL);
        //console.log('Frontend URL:', window.FRONTEND_URL);
    </script>
    
    <script src="main_dynamic.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (!window.voiceAgent) {
                window.voiceAgent = new DynamicVoiceAgent();
            }
        });
    </script>
</body>
</html>